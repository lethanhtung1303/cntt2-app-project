<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.tdtu.webproject.mybatis.mapper.UserRolesSupportMapper">
    <resultMap id="BaseResultMap" type="com.tdtu.webproject.mybatis.result.UserRolesResult">
        <id column="ID" jdbcType="NUMERIC" property="id"/>
        <result column="IDCATEGORY" jdbcType="NUMERIC" property="idCategory"/>
        <result column="NAMECATEGORYNAMEVN" jdbcType="VARCHAR" property="nameCategoryNameVN"/>
        <result column="EMPLOYEEID" jdbcType="NUMERIC" property="employeeID"/>
        <result column="ROLEVIEW" jdbcType="NUMERIC" property="roleView"/>
        <result column="ROLEUPDATE" jdbcType="NUMERIC" property="roleUpdate"/>
        <result column="ROLEDELETE" jdbcType="NUMERIC" property="roleDelete"/>
    </resultMap>

    <select id="loadRoleDetail" resultMap="BaseResultMap">
        SELECT rc.ID AS ID,
        rc.ID AS IDCATEGORY,
        rc.CATEGORYNAMEVN AS NAMECATEGORYNAMEVN,
        ${employeeID} AS EMPLOYEEID,
        COALESCE(r.ROLEVIEW, 0) AS ROLEVIEW,
        COALESCE(r.ROLEUPDATE, 0) AS ROLEUPDATE,
        COALESCE(r.ROLEDELETE, 0) AS ROLEDELETE
        FROM TDT_ROLECATEGORY rc
        LEFT JOIN TDT_ROLE r ON
        r.CATEGORYROLE = rc.id
        <if test="(employeeID != null and employeeID != '')">
            AND r.EMPLOYEEID = ${employeeID}
        </if>
        LEFT JOIN TDT_INSTRUCTOR e ON
        e.INSTRUCTORID = r.EMPLOYEEID
        WHERE r.ISACTIVE IS NULL
        OR r.ISACTIVE != 0;
    </select>
</mapper>
